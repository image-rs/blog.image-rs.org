---
layout: post
author: HeroicKatora
title: "Release of version 0.22"
---

We, the image-rs group, are glad to announce the release of a new version of
the central `image` library. This is especially noteworthy since it resolves
some long standing interface issues, removes some old deprecated items and
marks some new ones, and finally contains a plethora of improvement to the set
of image decoders and encoders.

## Notable changes

We have updated the compiler requirements to Rust `1.34.2`, together with the
Debian stable release Buster.

A general rework of the `ImageDecoder` trait. All decoders now have their own
reader types which allows greater flexibility for the future. These were
intended to offer an `std::io::Read` interface only.  If this leads to
performance pessimissations it would be possible to introduce dedicated methods
for concrete decoders.

Multiple `unsafe` interfaces have been retired. The likely broken generic
`PixelsMut` iterator of `GenericImage` has been removed (was deprecated). Note
that the specialized version on `ImageBuffer` is still available and an even
more diverse set of iterators has been added for it, e.g. `RowsMut`.

Colors as now tuple types. This had ergonomic problems in a rather ancient
version of Rust. As a style help, remember that you can match tuples and slices
exhaustively on the left-hand side of an assignment, like so:

```
let Rgb([r, g, b]) = image.get_pixel(10, 10);
```

The `overlay` and `replace` operations no longer require both image types to be
the same but only their pixels. These changes are complementary to an update to
the `GenericImage::copy_from` method, which previously returned a `bool` to
indicate success. This could silently fail to do anything.

## Future changes

There are already important plans for the next version. The ecosystem is slowly
moving towards edition 2018, which is now the default for new projects, and
many improvements on quality of life but also semantic clarity are dearly
missed once one has gotten used to them[^extras]. Thus, we plan to make the
move away from supporting `rustc 1.24.1` as soon as the next Debian stable
release supports it.

In an effort to remove even more `unsafety` from the library there are also
some newly depreated methods on top of some previously deprated parts that were
removed. These will stay until we have figured out the best solution to replace
their current functionality.

[^extras]: Such as `TryFrom` for integer conversion, improvements for reference
    matching, nested imports, basic `const` functions, endianess conversion on
    integers types, `#[repr(transparent)]`, more in `core`, `impl Trait` returns
    and many many more.
